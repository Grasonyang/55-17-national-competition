<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="./assets/style.css">
</head>
<body>
    <div>
        <input type="number" min="1">
        <button onclick="draw()">繪製</button>
    </div>
    <canvas height="500" width="500"></canvas>
    <script src="./assets/jquery.min.js"></script>
</body>
<script>
    let canvas = document.querySelector('canvas');
    let ctx = canvas.getContext('2d');
    let basic_triangle = [
        [
            {
                x:250,
                y:0
            },
            {
                x:0,
                y:500
            },
            {
                x:500,
                y:500
            },
        ]
    ]
    function draw(){
        let result = calculate(basic_triangle, $("input").val()-1);
        drawTriangles(result);
    }
    function calculate(triangles, number){
        // 取得每個三角形邊的中點
        if(number <=0)
            return triangles;
        let new_triangles = [];
        for(let i = 0; i < triangles.length; i++){
            let triangle = triangles[i];
            let p1 = triangle[0];
            let p2 = triangle[1];
            let p3 = triangle[2];
            let mid1 = {
                x: (p1.x + p2.x) / 2,
                y: (p1.y + p2.y) / 2
            };
            let mid2 = {
                x: (p2.x + p3.x) / 2,
                y: (p2.y + p3.y) / 2
            };
            let mid3 = {
                x: (p1.x + p3.x) / 2,
                y: (p1.y + p3.y) / 2
            };
            new_triangles.push([
                p1, mid1, mid3
            ]);
            new_triangles.push([
                mid1, p2, mid2
            ]);
            new_triangles.push([
                mid2, mid3, p3
            ]);
        }
        return calculate(new_triangles, number - 1);
    }
    function drawTriangles(triangles){
        // 繪製三角形
        console.log(triangles);
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        for(let i = 0; i < triangles.length; i++){
            let triangle = triangles[i];
            ctx.beginPath();
            ctx.moveTo(triangle[0].x, triangle[0].y);
            ctx.lineTo(triangle[1].x, triangle[1].y);
            ctx.lineTo(triangle[2].x, triangle[2].y);
            ctx.fillStyle = 'rgba(0, 0, 0)';
            ctx.fill();
            ctx.closePath();
            ctx.stroke();
        }
    }
</script>
</html>